:root {
  --primary: #7c4dff;
  --primary-dark: #5e35b1;
  --bg: #f6f7fb;
  --card: #ffffff;
  --text: #2b2b2b;
  --border: #e6e8ee;
}

body {
  margin: 0;
  font-family: 'Roboto', sans-serif;
  background: var(--bg);
  color: var(--text);
}

.app-header {
  background: linear-gradient(90deg, var(--primary-dark), var(--primary));
  color: #fff;
  padding: 16px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  min-height: 64px;
  width: 100%;
  box-sizing: border-box;
}

.brand {
  display: flex;
  align-items: center;
  gap: 10px;
}

.actions {
  display: flex;
  gap: 10px;
  align-items: center;
}

/* Admin-only controls are hidden by default. Revealed only after entering password. */
.admin-hidden { display: none !important; }

/* Header-specific button styling for contrast on dark gradient */
.app-header .btn-outline {
  color: #fff;
  border-color: rgba(255,255,255,0.22);
  background: transparent;
}
.app-header .btn {
  box-shadow: 0 2px 6px rgba(0,0,0,0.12);
}
.app-header .btn:disabled,
.app-header .btn[disabled] {
  opacity: 0.45;
  cursor: default;
}

.search input {
  padding: 8px 12px;
  border-radius: 8px;
  border: none;
}

.container {
  max-width: 900px;
  margin: 20px auto;
  padding: 0 12px;
}

.table-controls { display:flex; justify-content:center; align-items:center; margin-bottom:10px; gap:12px; }
.table-controls .controls-left { display:flex; gap:8px; align-items:center; }
.table-controls input[type="text"] { padding:8px 10px; border-radius:6px; border:1px solid var(--border); }

/* Tag filters (seco/congelado/fresco) placed near table controls */
.tag-filters { display:flex; gap:10px; align-items:center; margin-left:12px; }
.tag-filter { display:flex; gap:6px; align-items:center; font-size:14px; color:#444; }
.tag-filter input[type="checkbox"] { width:16px; height:16px; }

.table {
  width: 100%;
  border-collapse: collapse;
  background: var(--card);
  border-radius: 12px;
  overflow: hidden;
  box-shadow: 0 6px 20px rgba(0,0,0,0.08);
}

.table th, .table td {
  padding: 14px 12px;
  border-bottom: 1px solid var(--border);
}

.table th {
  background: #f1ecff;
  color: #2b1b64;
  text-align: left;
}

.table tr:hover {
  background: #faf7ff;
}

.btn {
  background: var(--primary);
  color: #fff;
  border: none;
  padding: 8px 12px;
  border-radius: 6px;
  cursor: pointer;
}

.btn:hover {
  background: var(--primary-dark);
}

.btn-outline {
  background: transparent;
  color: var(--primary);
  border: 1px solid var(--primary);
}

.toast {
  position: fixed;
  bottom: 20px;
  right: 20px;
  background: #2f2f2f;
  color: #fff;
  padding: 12px 14px;
  border-radius: 8px;
  opacity: 0;
  transform: translateY(8px);
  transition: opacity 240ms ease, transform 240ms ease;
  pointer-events: none;
}

.toast.show {
  opacity: 1;
  transform: translateY(0);
  pointer-events: auto;
}

.toast.success { background: #2e7d32; }
.toast.error { background: #c62828; }

/* Toast action button */
.toast .toast-btn {
  margin-left: 10px;
  background: transparent;
  border: 1px solid rgba(255,255,255,0.2);
  color: #fff;
  padding: 6px 8px;
  border-radius: 6px;
  cursor: pointer;
}
.toast .toast-btn:hover { opacity: 0.9; }

/* Highlight rows added/updated via import */
.row-added { animation: highlight-add 2.4s ease; }
.row-updated { animation: highlight-update 2.4s ease; }
@keyframes highlight-add {
  0% { background: #e8f5e9; }
  100% { background: transparent; }
}
@keyframes highlight-update {
  0% { background: #fff8e1; }
  100% { background: transparent; }
}

/* Product cell image */
.product-cell {
  display: flex;
  align-items: center;
  gap: 12px;
}
.product-cell img {
  width: 64px;
  height: 64px;
  object-fit: cover;
  border-radius: 8px;
  flex: 0 0 64px;
}

/* Modal / popover styles */
#modal {
  position: fixed;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  z-index: 1000;
}
#modal.hidden { display: none; }
.modal-backdrop {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.35);
  z-index: 900;
}
.modal-content {
  background: var(--card);
  padding: 12px 14px;
  border-radius: 8px;
  box-shadow: 0 6px 20px rgba(0,0,0,0.12);
  min-width: 300px;
}

/* Modal grid layout for desktop: two columns to avoid very tall popover */
.modal-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; align-items: start; }
.modal-field label { display:block; margin-bottom:6px; font-size:14px; color:#333; }
.modal-field input[type="text"], .modal-field input[type="number"], .modal-field input[type="date"] { width:100%; padding:8px 10px; border-radius:6px; border:1px solid var(--border); box-sizing:border-box; }
.icon-row .icon-input { display:inline-flex; align-items:center; gap:8px; }
.icon-preview img { width:48px; height:48px; object-fit:cover; border-radius:6px; border:1px solid var(--border); }

/* Make checkboxes look cleaner using accent-color and sizing */
.tag-filter input[type="checkbox"], .tag-filters input[type="checkbox"], .tag-inputs input[type="checkbox"] {
  width:18px; height:18px; accent-color:var(--primary); margin-right:6px; vertical-align:middle;
}
.tag-filter { display:inline-flex; align-items:center; gap:6px; font-size:14px; color:#333; }

/* Form layout inside modal */
.modal-content label {
  display: block;
  margin-bottom: 10px;
  font-size: 14px;
  color: #333;
}
.modal-content label input[type="text"],
.modal-content label input[type="number"],
.modal-content label input[type="date"] {
  width: 100%;
  padding: 8px 10px;
  border-radius: 6px;
  border: 1px solid var(--border);
  margin-top: 6px;
  box-sizing: border-box;
}
.modal-actions { display:flex; gap:8px; justify-content:flex-end; margin-top:12px; }

/* Icon input and preview */
.icon-input { display:flex; gap:8px; align-items:center; }
.icon-input input { flex:1; }
.icon-preview { margin-top:8px; }
.icon-preview img { width:48px; height:48px; object-fit:cover; border-radius:6px; border:1px solid var(--border); }

/* Stock controls inline */
.stock-controls { display:flex; align-items:center; gap:8px; }
.stock-controls .stock-value { min-width:36px; text-align:center; font-weight:600; }

/* History panel */
.history-panel { position:fixed; z-index:1300; right:20px; bottom:80px; width:320px; max-height:60vh; overflow:auto; background:var(--card); border-radius:8px; box-shadow:0 8px 30px rgba(0,0,0,0.12); padding:10px; }
.history-panel h3 { margin:0 0 8px 0; font-size:14px; }
.history-entry { padding:8px; border-radius:6px; display:flex; justify-content:space-between; gap:8px; align-items:center; border:1px solid var(--border); margin-bottom:8px; }
.history-entry .desc { font-size:13px; color:#333; }
.history-entry .meta { font-size:12px; color:#666; }
.history-entry .entry-btn { background:transparent; border:1px solid var(--primary); color:var(--primary); padding:6px 8px; border-radius:6px; cursor:pointer; }
.history-empty { padding:12px; color:#666; text-align:center; }

/* Icon picker popover */
.icon-picker { position:fixed; z-index:1200; background:var(--card); border-radius:8px; padding:10px; box-shadow:0 6px 20px rgba(0,0,0,0.12); display:none; height: fit-content; height: -webkit-fit-content; }
.icon-picker.visible { display:block; }
.icon-picker .grid { display:grid; grid-template-columns:repeat(4, 1fr); gap:8px; max-width:360px; }
.icon-picker .item { cursor:pointer; padding:6px; border-radius:6px; text-align:center; }
.icon-picker .item img { width:56px; height:56px; object-fit:cover; border-radius:6px; }
.icon-picker .item:hover { background:#f3f2ff; }

/* Popover variant: appears near button */
.modal.popover {
  position: absolute;
  transform: none;
  left: 0;
  top: 0;
  z-index: 1100;
}
.modal.popover .modal-content { min-width: 260px; }

.modal.popover::before {
  content: "";
  position: absolute;
  left: -8px;
  top: 18px;
  width: 0;
  height: 0;
  border-top: 8px solid transparent;
  border-bottom: 8px solid transparent;
  border-right: 8px solid var(--card);
}
.modal.popover.popover-left::before {
  left: auto;
  right: -8px;
  border-right: none;
  border-left: 8px solid var(--card);
}

/* Responsive: on small screens show popover centered and hide arrow */
@media (max-width: 520px) {
  .modal.popover { position: fixed; left: 50%; top: 50%; transform: translate(-50%, -50%); }
  .modal.popover::before { display: none; }
  .icon-picker { position: fixed; left: 50%; top: 50%; transform: translate(-50%, -50%); max-width: 92%; }
  .icon-picker .grid { grid-template-columns: repeat(2, 1fr); gap:8px; }
}

/* For medium screens (<1000px) keep layout single column and reduce font-sizes as requested */
@media (max-width: 1000px) {
  .modal-grid { grid-template-columns: 1fr; }
  .modal-content { font-size: 13px; }
  .modal-field label { font-size: 13px; }
  .modal-field input[type="text"], .modal-field input[type="number"], .modal-field input[type="date"] { font-size: 13px; padding:7px 8px; }
  .icon-preview img { width:36px; height:36px; }
  .tag-filter { font-size:12px; }
  .tag-filter input[type="checkbox"] { width:12px; height:12px; }
}

/* Slightly larger spacing on wide desktop for popover */
@media (min-width: 1001px) {
  .modal-content { min-width: 420px; }
}

/* Responsive: compact table for small/medium screens â€” keep table layout but shrink sizes and allow horizontal scroll */
@media (max-width: 720px) {
  .app-header { padding: 10px 12px; align-items: center; }
  /* Stack header: title centered on top, actions full-width below */
  .app-header { flex-direction: column; align-items: center; }
  .app-header .brand { width:100%; display:flex; justify-content:center; align-items:center; gap:8px; order: 1; }
  .app-header .actions { order: 2; width:100%; justify-content:center; }
  .app-header .actions { display:flex; flex-wrap:wrap; gap:8px; margin-top:8px; justify-content:center; }
  .app-header .actions .btn, .app-header .actions .btn-outline { padding:6px 8px; font-size:14px; min-width:56px; }
  .container { margin: 8px; padding: 0 8px; }
  .table { box-shadow: none; border-radius: 8px; overflow-x: auto; -webkit-overflow-scrolling: touch; }
  .table th, .table td { padding: 8px 10px; font-size: 13px; white-space: nowrap; }
  .table thead { display: table-header-group; }
  .product-cell { display:flex; align-items:center; gap:8px; }
  .product-cell img { width:32px; height:32px; flex: 0 0 32px; }
  .product-cell div { flex:1; min-width:0; }
  .stock-controls { gap:8px; }
  .stock-controls .stock-value { min-width:34px; font-size:13px; }
  .modal-content { min-width: auto; width: calc(100vw - 24px); box-sizing: border-box; }
  .icon-picker { position: fixed; left: 50%; transform: translateX(-50%); bottom: 20px; top: auto; max-width: 96%; }
  /* Prefer 2 columns on narrow/phone screens so icons remain large and avoid overflow */
  .icon-picker .grid { grid-template-columns: repeat(2, 1fr); gap:6px; }
  .icon-picker .item img { width:40px; height:40px; }

  /* Ensure table controls (buttons + search) can wrap into two lines without overflowing */
  .table-controls { display:flex; flex-wrap:wrap; gap:8px; justify-content:space-between; }
  .table-controls .controls-left, .table-controls .controls-right { display:flex; flex-wrap:wrap; gap:8px; align-items:center; }

  .tag-filters { width:100%; justify-content:flex-start; margin-top:6px; }
}

/* Mobile-specific: smaller checkboxes and tag label text */
@media (max-width: 720px) {
  .tag-filter input[type="checkbox"] { width:12px; height:12px; }
  .tag-filter { font-size:12px; }
}

/* Desktop: make edit popover wider so it distributes horizontally rather than very tall */
@media (min-width: 721px) {
  .modal.popover .modal-content { min-width: 480px; max-width: 70vw; }
}

/* Modal adjustments for mobile: reduce font sizes and icon sizes inside the edit modal */
@media (max-width: 520px) {
  .modal-content label { font-size: 13px; }
  .modal-content label input[type="text"],
  .modal-content label input[type="number"],
  .modal-content label input[type="date"] { font-size:13px; padding:6px 8px; }
  .modal-actions .btn { padding:8px 10px; font-size:13px; }
  .icon-preview img { width:36px; height:36px; }
  .icon-picker .item img { width:36px; height:36px; }
}

@media (max-width: 400px) {
  .modal-content label { font-size: 12px; }
  .modal-content label input[type="text"],
  .modal-content label input[type="number"],
  .modal-content label input[type="date"] { font-size:12px; padding:5px 6px; }
  .icon-preview img { width:32px; height:32px; }
  .modal-actions .btn { padding:6px 8px; font-size:12px; }
}

/* Keep clear cache button visible and fixed on small screens so user can always access it */
@media (max-width: 720px) {
  #clearCacheBtn {
    position: fixed !important;
    top: 8px !important;
    right: 8px !important;
    z-index: 2200 !important;
    padding: 6px 8px !important;
    font-size: 11px !important;
  }
  #forceSyncBtn {
    position: fixed !important;
    top: 8px !important;
    right: 110px !important;
    z-index: 2200 !important;
    padding: 6px 8px !important;
    font-size: 11px !important;
  }
}

/* Extra small screens (iPhone portrait ~390px) tweaks */
@media (max-width: 400px) {
  :root { --primary: #7c4dff; }
  .container { padding: 0 10px; }
  .app-header { padding: 10px; }
  .app-header .brand img { width: 34px; height: 34px; }
  .app-header .brand .title { font-size: 16px; }
  .actions .btn, .btn { padding: 10px 12px; font-size: 15px; }
  .table tr { padding: 12px; }
  .product-cell img { width:44px; height:44px; }
  .product-cell { gap:8px; }
  .stock-controls .stock-value { min-width:44px; font-size:15px; }
  /* icon picker: 3 columns to avoid tiny icons on very small screens */
  /* Use 2 columns on very small screens (phone) */
  .icon-picker .grid { grid-template-columns: repeat(2, 1fr); gap:6px; max-width: 96vw; }
  .icon-picker { left: 50%; transform: translateX(-50%); bottom: 12px; top: auto; }
  /* toast centered and wider for readability */
  .toast { left: 50%; right: auto; transform: translateX(-50%) translateY(8px); width: calc(100% - 40px); max-width: 520px; bottom: 14px; }
  /* modal full-width friendly */
  .modal-content { padding: 14px; width: calc(100vw - 28px); }
  /* further compact layout for very small screens */
  .app-header .actions { gap:6px; }
  .app-header .actions .btn, .app-header .actions .btn-outline, .btn { padding:6px 8px; font-size:13px; }
  .table th, .table td { padding:8px 10px; font-size:13px; }
  .product-cell img { width:36px; height:36px; flex: 0 0 36px; }
  .product-cell .name, .product-cell .code { font-size:13px; }
  /* make table-controls wrap into two lines if needed */
  .table-controls { flex-wrap: wrap; gap:8px; }
  .table-controls .controls-left, .table-controls .controls-right { width:100%; display:flex; flex-wrap:wrap; gap:8px; }
}

/* Medium small screens: reduce font to 10px and tighten spacing */
@media (max-width: 1000px) {
  .table th, .table td { font-size: 10px; padding: 6px 8px; }
  .product-cell { gap: 6px; }
  .product-cell img { width: 28px; height: 28px; flex: 0 0 28px; }
  .stock-controls .stock-value { min-width:30px; font-size:12px; }
  /* make small stock buttons smaller if present */
  .stock-controls button, .stock-controls .btn { padding:4px 6px; font-size:12px; }
  .table-controls input[type="text"] { padding:6px 8px; font-size:12px; }
}

/* Very small screens: <=500px use compact sizing and 8px fonts */
@media (max-width: 500px) {
  :root { --card-padding: 6px; }
  .table th, .table td { font-size: 8px; padding: 3px 1px; }
  .product-cell { gap: 3px; }
  .product-cell img { width: 20px; height: 20px; flex: 0 0 20px; }
  /* truncate product name to ~25 characters with ellipsis */
  .product-cell > div > div { display: inline-block; max-width: 25ch; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; vertical-align: middle; }
  .product-cell .name, .product-cell .code { font-size: 8px; }
  .stock-controls .stock-value { min-width:2px; font-size:8px; }
  .stock-controls button, .btn-stock-plus, .btn-stock-minus { padding:2px 4px; font-size:8px; }
  /* edit button compact */
  .btn-edit { font-size:8px; padding:4px; }
  .btn, .btn-outline { padding:6px 8px; font-size:10px; }
  .table-controls { gap:6px; }
  .table-controls input[type="text"] { padding:5px 6px; font-size:10px; }
  /* reduce icon-picker sizes too */
  .icon-picker .item img { width:30px; height:30px; }
  /* ensure horizontal table scroll still works but reduce whitespace */
  .table { overflow-x: auto; }
}

/* Ensure popover modals are centered on very small screens even if JS sets inline position */
@media (max-width: 520px) {
  .modal.popover {
    position: fixed !important;
    left: 50% !important;
    top: 50% !important;
    transform: translate(-50%, -50%) !important;
    visibility: visible !important;
  }
  .modal.popover::before { display: none !important; }
}

/* Make action buttons' font smaller on mobile */
@media (max-width: 720px) {
  .app-header .actions .btn, .app-header .actions .btn-outline { font-size: 8px !important; padding:6px 6px !important; }
}
